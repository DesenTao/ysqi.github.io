<!DOCTYPE html><html xmlns="https://www.w3.org/1999/xhtml" xmlns:og="https://ogp.me/ns#" lang="zh" id="doc" class="no-js"><head><title>Mac下搭建以太坊私有链 |虞双齐的博客</title><meta name="description" content="在熟悉了解以太坊Ethereum时，为加快测试和掌握。在本机搭建私有链环境是必须的。 小编摸索一段时"><meta name="keywords" content="以太坊, "><meta name="author" content="虞双齐"><meta name="generator" content="Hugo 0.17"><meta name="viewport" content="width=device-width,initial-scale=1"><meta name="renderer" content="webkit"><meta name="applicable-device" content="pc,mobile"><meta name="MobileOptimized" content="width"><meta name="HandheldFriendly" content="true"><meta name="mobile-web-app-capable" content="yes"><link rel="icon" sizes="32x32" href="/img/favicon.ico"><meta name="apple-mobile-web-app-capable" content="yes"><meta name="apple-mobile-web-app-status-bar-style" content="black"><meta name="apple-mobile-web-app-title" content="虞双齐"><link rel="apple-touch-icon-precomposed" href="/img/app-icon64x64.png"><meta name="msapplication-TileImage" content="/img/app-icon128x128.png"><meta name="msapplication-TileColor" content="#0e90d2"><meta property="og:site_name" content="虞双齐的博客"><meta property="og:locale" content="zh"><meta property="og:url" content="https://yushuangqi.com/blog/2017/mac%E4%B8%8B%E6%90%AD%E5%BB%BA%E4%BB%A5%E5%A4%AA%E5%9D%8A%E7%A7%81%E6%9C%89%E9%93%BE.html"><meta property="og:title" content="Mac下搭建以太坊私有链"><meta property="og:type" content="article"><meta property="article:published_time" content="2017-09-09 10:22:26"><meta property="article:modified_time" content="2017-09-09 10:22:26"><meta property="article:tag" content="以太坊"><meta name="og:description" content="在熟悉了解以太坊Ethereum时，为加快测试和掌握。在本机搭建私有链环境是必须的。 小编摸索一段时"><link rel="stylesheet" type="text/css" href="/css/jiandan.css?v=20170816"><script type="text/javascript">var doc = document.getElementById('doc');
	doc.removeAttribute('class', 'no-js');
	doc.setAttribute('class', 'js');</script><script type="text/javascript">var changeActive = function() {
		var page = document.getElementById("page");		
		if (page.getAttribute("class") === "not-active") {
			page.setAttribute("class", "active-sidebar");		
		} else if (page.getAttribute("class") === "active-sidebar") {
			page.setAttribute("class", "not-active");
		}		
	}
	
	window.onload = function() {
		if(document.getElementById("sidebar-button")) {
			var sidebar_button = document.getElementById("sidebar-button");
			sidebar_button.onclick = function(event) {
				changeActive();
				event.preventDefault();
			}
		}
		
	}
	
	window.onresize = function() {
		var page = document.getElementById("page");	
		page.setAttribute("class", "not-active");	
	}</script></head><body id="page" class="not-active"><div class="container"><header class="header writingsheader"><nav class="off-canvas-nav-links"><ul><li class="menuli"><a class="menubutton" href="#menu">Menu</a></li><li id="site-title"><a class="menulogo" id="sidebar-button" href="#sidebar">附件信息</a></li></ul></nav></header><section role="main"><article class="entry writingsentry" itemscope itemtype="http://schema.org/BlogPosting"><header><h1 itemprop="headline"><a rel="bookmark" href="https://yushuangqi.com/blog/2017/mac%E4%B8%8B%E6%90%AD%E5%BB%BA%E4%BB%A5%E5%A4%AA%E5%9D%8A%E7%A7%81%E6%9C%89%E9%93%BE.html">Mac下搭建以太坊私有链</a></h1><p class="attribution"><span itemprop="author"><span itemscope itemtype="http://schema.org/Person">文/ <a href="https://yushuangqi.com"><span itemprop="name">虞双齐</span></a> </span></span><span class="right"><time itemprop="datePublished" datetime="2017-09-09">2017年09月09日</time></span></p></header><div itemprop="articleBody"><p>在熟悉了解以太坊Ethereum时，为加快测试和掌握。在本机搭建私有链环境是必须的。 小编摸索一段时间，总算了解到以太坊的总体运行环境。下面以go-ethereum和以太坊钱包为例，详细步骤记录如何在Mac下搭建以太坊私有链运行环境。</p><h2 id="配置前环境准备">配置前环境准备</h2><h3 id="安装以太坊客户端">安装以太坊客户端</h3><p>实际以太坊运行有多个不同语言实现的客户端，是多样的。可为不同用户选择他们所熟悉的客户端。</p><table><thead><tr><th>客户端</th><th>开发语言</th><th>开发者</th></tr></thead><tbody><tr><td><a href="http://ethdocs.org/en/latest/ethereum-clients/go-ethereum/index.html#go-ethereum">go-ethereum</a></td><td>Go</td><td><a href="https://ethereum.org/foundation">以太坊基金会</a></td></tr><tr><td><a href="http://ethdocs.org/en/latest/ethereum-clients/parity/index.html#parity">Parity</a></td><td>Rust</td><td><a href="https://parity.io/">Ethcore</a></td></tr><tr><td><a href="http://ethdocs.org/en/latest/ethereum-clients/cpp-ethereum/index.html#cpp-ethereum">cpp-ethereum</a></td><td>C++</td><td><a href="https://ethereum.org/foundation">以太坊基金会</a></td></tr><tr><td><a href="http://ethdocs.org/en/latest/ethereum-clients/pyethapp/index.html#pyethapp">pyethapp</a></td><td>Python</td><td><a href="https://ethereum.org/foundation">以太坊基金会</a></td></tr><tr><td><a href="http://ethdocs.org/en/latest/ethereum-clients/ethereumjs-lib/index.html#ethereumjs-lib">ethereumjs-lib</a></td><td>Javascript</td><td><a href="https://ethereum.org/foundation">以太坊基金会</a></td></tr><tr><td><a href="http://ethdocs.org/en/latest/ethereum-clients/ethereumj/index.html#ethereum-j">Ethereum(J)</a></td><td>Java</td><td><a href="http://www.ether.camp">ether camp</a></td></tr><tr><td><a href="http://ethdocs.org/en/latest/ethereum-clients/ruby-ethereum/index.html#ruby-ethereum">ruby-ethereum</a></td><td>Ruby</td><td><a href="https://github.com/janx/">国人Xie Jan</a></td></tr><tr><td><a href="http://ethdocs.org/en/latest/ethereum-clients/ethereumh/index.html#ethereumh">ethereumH</a></td><td>Haskell</td><td><a href="http://www.blockapps.net/">BlockApps</a></td></tr></tbody></table><p>因为以太坊客户端以 go-ethereum 为主，故搭建私有链也使用该客户端。</p><ul><li><a href="https://github.com/ethereum/go-ethereum/wiki/Installation-Instructions-for-Mac">Mac OS X上安装说明</a></li><li><a href="https://github.com/ethereum/go-ethereum/wiki/Installation-instructions-for-Windows">Windows 上安装说明</a></li></ul><p>在Mac上安装细节如下： 在使用brew前，需自行安装brew软件管理工具(<a href="http://brew.sh)。">http://brew.sh)。</a> 因为以太坊客户端涉及到多个依赖安装，故先tap再安装</p><div class="highlight" style="background:#f0f0f0"><pre style="line-height:125%"><span></span>brew tap ethereum/ethereum 
brew install ethereum 
</pre></div><p>可通过参数<code>--devel</code>直接安装开发版本(<strong>可选</strong>)</p><div class="highlight" style="background:#f0f0f0"><pre style="line-height:125%"><span></span>brew install ethereum --devel 
</pre></div><p>安装完成后，可执行命令<code>geth version</code>查看版本信息，结果如下：</p><div class="highlight" style="background:#f0f0f0"><pre style="line-height:125%"><span></span>Geth
Version: 1.6.7-stable
Git Commit: ab5646c532292b51e319f290afccf6a44f874372
Architecture: amd64
Protocol Versions: [63 62]
Network Id: 1
Go Version: go1.9
Operating System: darwin
GOPATH=/Users/one/Documents/dev/go
GOROOT=/usr/local/Cellar/go/1.9/libexec
</pre></div><p>其中 <code>geth</code>为客户端命令。</p><h3 id="初始化创世区块">初始化创世区块</h3><p>因为geth默认的文件存储路径是：<code>$HOME/Library/Ethereum/</code> ，故为运行方便，小编将配置文件等均放置在此目录。</p><blockquote><p><strong>坑</strong> : geth 是支持指定存储目录的<code>--datadir</code>，但后面会遇到各种奇怪问题，如矿工一直不挖矿<a href="https://github.com/ethereum/go-ethereum/issues/2174">Issue</a>等。</p></blockquote><div class="highlight" style="background:#f0f0f0"><pre style="line-height:125%"><span></span>{
  <span style="color:#062873;font-weight:700">&quot;nonce&quot;</span>: <span style="color:#4070a0">&quot;0x0000000000000042&quot;</span>,
  <span style="color:#062873;font-weight:700">&quot;difficulty&quot;</span>: <span style="color:#4070a0">&quot;0x020000&quot;</span>,
  <span style="color:#062873;font-weight:700">&quot;mixhash&quot;</span>: <span style="color:#4070a0">&quot;0x0000000000000000000000000000000000000000000000000000000000000000&quot;</span>,
  <span style="color:#062873;font-weight:700">&quot;coinbase&quot;</span>: <span style="color:#4070a0">&quot;0x0000000000000000000000000000000000000000&quot;</span>,
  <span style="color:#062873;font-weight:700">&quot;timestamp&quot;</span>: <span style="color:#4070a0">&quot;0x00&quot;</span>,
  <span style="color:#062873;font-weight:700">&quot;parentHash&quot;</span>: <span style="color:#4070a0">&quot;0x0000000000000000000000000000000000000000000000000000000000000000&quot;</span>,
  <span style="color:#062873;font-weight:700">&quot;extraData&quot;</span>: <span style="color:#4070a0">&quot;0x11bbe8db4e347b4e8c937c1c8370e4b5ed33adb3db69cbdb7a38e1e50b1b82fa&quot;</span>,
  <span style="color:#062873;font-weight:700">&quot;gasLimit&quot;</span>: <span style="color:#4070a0">&quot;0x4c4b40&quot;</span>,
  <span style="color:#062873;font-weight:700">&quot;config&quot;</span>: {
      <span style="color:#062873;font-weight:700">&quot;chainId&quot;</span>: <span style="color:#40a070">15</span>,
      <span style="color:#062873;font-weight:700">&quot;homesteadBlock&quot;</span>: <span style="color:#40a070">0</span>,
      <span style="color:#062873;font-weight:700">&quot;eip155Block&quot;</span>: <span style="color:#40a070">0</span>,
      <span style="color:#062873;font-weight:700">&quot;eip158Block&quot;</span>: <span style="color:#40a070">0</span>
  },
  <span style="color:#062873;font-weight:700">&quot;alloc&quot;</span>: { }
}
</pre></div><p>将创世初始化文件保存到<code>$HOME/Library/Ethereum/</code>下文件名genesis.json。 初始区块是区块链的起始 — 第一个区块，区块0，唯一没有指向前面区块的一个区块。协议确保其他节点不会和你的区块链一致，除非他们和你有相同的初始区块，这样你想创建多少私有测试网区块链，就可以创建多少！</p><p>执行初始化：</p><div class="highlight" style="background:#f0f0f0"><pre style="line-height:125%"><span></span><span style="color:#007020">cd</span> <span style="color:#bb60d5">$HOME</span>/Library/Ethereum/
geth  init genesis.json
</pre></div><p>执行后，将提示成功初始化创世区。</p><div class="highlight" style="background:#f0f0f0"><pre style="line-height:125%"><span></span>geth  init genesis.json
WARN [09-09|10:27:44] No etherbase set and no accounts found as default
INFO [09-09|10:27:44] Allocated cache and file handles        database=/Users/one/Library/Ethereum/geth/chaindata cache=16 handles=16
INFO [09-09|10:27:44] Writing custom genesis block
INFO [09-09|10:27:44] Successfully wrote genesis state        database=chaindata                                        hash=bd0e7a…9aadd0
INFO [09-09|10:27:44] Allocated cache and file handles        database=/Users/one/Library/Ethereum/geth/lightchaindata cache=16 handles=16
INFO [09-09|10:27:44] Writing custom genesis block
INFO [09-09|10:27:44] Successfully wrote genesis state        database=lightchaindata                                        hash=bd0e7a…9aadd0
</pre></div><p>此时可看到该目录下会多出两个文件夹:geth和keystore</p><div class="highlight" style="background:#f0f0f0"><pre style="line-height:125%"><span></span>├── genesis.json
├── geth
│  ├── chaindata
│  │  ├── 000001.log
│  │  ├── CURRENT
│  │  ├── LOCK
│  │  ├── LOG
│  │  └── MANIFEST-000000
│  └── lightchaindata
│      ├── 000001.log
│      ├── CURRENT
│      ├── LOCK
│      ├── LOG
│      └── MANIFEST-000000
└── keystore
</pre></div><h3 id="初始化账号">初始化账号</h3><p>向将密码明文保存到文本文件中，本文中密码将全部是<code>abc</code></p><div class="highlight" style="background:#f0f0f0"><pre style="line-height:125%"><span></span><span style="color:#007020">cd</span> <span style="color:#bb60d5">$HOME</span>/Library/Ethereum/
<span style="color:#007020">echo</span> <span style="color:#4070a0">&quot;abc&quot;</span> &gt; pwd.txt 
</pre></div><p>运行命令创建账户</p><pre><code>geth  -password pwd.txt account new
WARN [09-09|10:33:10] No etherbase set and no accounts found as default
Address: {e7a614776754b7c7ef3a1ef6430d29e90411fd75}
</code></pre><p>虽然此账户可以在以太坊的JavaScript控制台中生成，但我一般直接通过命令工具生成，关于<code>geth account</code>命令还有更多信息：</p><div class="highlight" style="background:#f0f0f0"><pre style="line-height:125%"><span></span>SAGE:
  geth account [options] command [command options] [arguments...] 

COMMANDS:
  list    汇总打印所有账号
  new     创建一个新账号
  update  更新已存在的账户
  import  导入私钥生成新的账号
  help, h 帮助
</pre></div><div class="highlight" style="background:#f0f0f0"><pre style="line-height:125%"><span></span>geth account list 
</pre></div><p>你应该可以看到上面所创建的账号。</p><div class="highlight" style="background:#f0f0f0"><pre style="line-height:125%"><span></span>Account #0: {e7a614776754b7c7ef3a1ef6430d29e90411fd75} keystore:///Users/one/Library/Ethereum/keystore/UTC--2017-09-09T02-33-10.598872595Z--e7a614776754b7c7ef3a1ef6430d29e90411fd75
</pre></div><p>表明账号的私钥保存在keystore文件夹下。</p><h3 id="进入控制台">进入控制台</h3><div class="highlight" style="background:#f0f0f0"><pre style="line-height:125%"><span></span>geth  --networkid <span style="color:#40a070">9999</span> console
</pre></div><p>运行命令，将进入控制台，打印出如下信息。该信息非常重要。能告诉你运行时环境与配置信息。</p><ul><li>Allocated cache and file handles 缓存存放目录</li><li>Disk storage enabled for ethash caches 数据存放目录</li><li>Disk storage enabled for ethash DAGs DAG数据存放目录</li><li>IPC endpoint opened IPC地址，<strong>重要</strong>，关系到后续以太坊钱包的链接</li></ul><div class="highlight" style="background:#f0f0f0"><pre style="line-height:125%"><span></span>INFO [09-09|10:40:36] Starting peer-to-peer node              instance=Geth/v1.6.7-stable-ab5646c5/darwin-amd64/go1.9
INFO [09-09|10:40:36] Allocated cache and file handles        database=/Users/one/Library/Ethereum/geth/chaindata cache=128 handles=1024
WARN [09-09|10:40:36] Upgrading chain database to use sequential keys
INFO [09-09|10:40:36] Database conversion successful
INFO [09-09|10:40:36] Initialised chain configuration          config=&quot;{ChainID: 15 Homestead: 0 DAO: &lt;nil&gt; DAOSupport: false EIP150: &lt;nil&gt; EIP155: 0 EIP158: 0 Metropolis: &lt;nil&gt; Engine: unknown}&quot;
INFO [09-09|10:40:36] Disk storage enabled for ethash caches  dir=/Users/one/Library/Ethereum/geth/ethash count=3
INFO [09-09|10:40:36] Disk storage enabled for ethash DAGs    dir=/Users/one/.ethash                      count=2
WARN [09-09|10:40:36] Upgrading db log bloom bins
INFO [09-09|10:40:36] Bloom-bin upgrade completed              elapsed=68.449µs
INFO [09-09|10:40:36] Initialising Ethereum protocol          versions=&quot;[63 62]&quot; network=9999
INFO [09-09|10:40:36] Loaded most recent local header          number=0 hash=bd0e7a…9aadd0 td=131072
INFO [09-09|10:40:36] Loaded most recent local full block      number=0 hash=bd0e7a…9aadd0 td=131072
INFO [09-09|10:40:36] Loaded most recent local fast block      number=0 hash=bd0e7a…9aadd0 td=131072
INFO [09-09|10:40:36] Starting P2P networking
INFO [09-09|10:40:38] UDP listener up                          self=enode://f28939fbbd6038c074f322b656f314250bbf7372523ee6d7d2fd6b67f86dba3f41cdf394ab3c57bd105cb96bec70337c6c19a09ca794b6f0c36c3d04119c7c39@[::]:30303
INFO [09-09|10:40:38] RLPx listener up                        self=enode://f28939fbbd6038c074f322b656f314250bbf7372523ee6d7d2fd6b67f86dba3f41cdf394ab3c57bd105cb96bec70337c6c19a09ca794b6f0c36c3d04119c7c39@[::]:30303
INFO [09-09|10:40:38] IPC endpoint opened: /Users/one/Library/Ethereum/geth.ipc
Welcome to the Geth JavaScript console!

instance: Geth/v1.6.7-stable-ab5646c5/darwin-amd64/go1.9
coinbase: 0xe7a614776754b7c7ef3a1ef6430d29e90411fd75
at block: 0 (Thu, 01 Jan 1970 08:00:00 CST)
datadir: /Users/one/Library/Ethereum
modules: admin:1.0 debug:1.0 eth:1.0 miner:1.0 net:1.0 personal:1.0 rpc:1.0 txpool:1.0 web3:1.0 
</pre></div><p>能在控制台中执行多种命令，具体见官方文档：<a href="https://github.com/ethereum/go-ethereum/wiki/JavaScript-Console">JavaScript-Console Wiki</a>。 这是一个交互式的Javascript执行环境，在这里面可以执行Javascript代码，其中&gt;是命令提示符。在这个环境里也内置了一些用来操作以太坊的Javascript对象，可以直接使用这些对象。这些对象主要包括：</p><ul><li>eth：包含一些跟操作区块链相关的方法</li><li>net：包含以下查看p2p网络状态的方法</li><li>admin：包含一些与管理节点相关的方法</li><li>miner：包含启动&amp;停止挖矿的一些方法</li><li>personal：主要包含一些管理账户的方法</li><li>txpool：包含一些查看交易内存池的方法</li><li>web3：包含了以上对象，还包含一些单位换算的方法</li></ul><h2 id="启动挖矿">启动挖矿</h2><p>如果你之前有部署运行过以太坊，请先将此目录下的DAG文件删除<code>rm -rf $HOME/.ethash/</code>。</p><p>参数说明</p><div class="highlight" style="background:#f0f0f0"><pre style="line-height:125%"><span></span>--nodiscover
</pre></div><p>使用这个命令可以确保你的节点不会被<strong>非手动</strong>添加你的人发现。否则，你的节点可能因为你与他有相同的创世文件和网络ID而被陌生人的区块链无意添加。</p><div class="highlight" style="background:#f0f0f0"><pre style="line-height:125%"><span></span>--maxpeers <span style="color:#40a070">0</span>
</pre></div><p>如果你不希望其他人连接到你的测试链，可以使用maxpeers 0。反之，如果你确切知道希望多少人连接到你的节点，你也可以通过调整数字来实现。</p><div class="highlight" style="background:#f0f0f0"><pre style="line-height:125%"><span></span>--rpc
</pre></div><p>这个指令可以激活你节点上的RPC界面。它在geth中通常被默认激活。</p><div class="highlight" style="background:#f0f0f0"><pre style="line-height:125%"><span></span>--rpcapi <span style="color:#4070a0">&quot;db,eth,net,web3&quot;</span>
</pre></div><p>这个命令可以决定允许什么API通过RPC进入。在默认情况下，geth可以在RPC激活web3界面。 <strong>记住</strong>：在RPC/IPC界面提供API，会使每个可以进入这个界面（例如dapp&rsquo;s）的人都有权限访问这个API。注意你激活的是哪个API。Geth会默认激活IPC界面上所有的API，以及RPC界面上的db,eth,net和web3 API。</p><div class="highlight" style="background:#f0f0f0"><pre style="line-height:125%"><span></span>--rpcport <span style="color:#4070a0">&quot;8080&quot;</span>
</pre></div><p>将8000改变为你网络上开放的任何端口。Geth的默认设置是8080.</p><pre><code>```shell
--rpccorsdomain &quot;https://yushuangqi.com&quot;
</code></pre><p>这个可以指示什么URL能连接到你的节点来执行RPC定制端任务。务必谨慎，输入一个特定的URL而不是wildcard ( * )，后者会使所有的URL都能连接到你的RPC实例。</p><div class="highlight" style="background:#f0f0f0"><pre style="line-height:125%"><span></span>--datadir <span style="color:#4070a0">&quot;/home/TestChain1&quot;</span>
</pre></div><p>这是你的私有链数据所储存在的数据目录（在nubits下）。选择一个与你以太坊公有链文件夹分开的位置。</p><div class="highlight" style="background:#f0f0f0"><pre style="line-height:125%"><span></span>--identity <span style="color:#4070a0">&quot;TestnetMainNode&quot;</span>
</pre></div><p>这会为你的节点设置一个身份，使之更容易在端点列表中被辨认出来。这个例子说明了这些身份如何在网络上出现。</p><div class="highlight" style="background:#f0f0f0"><pre style="line-height:125%"><span></span>--networkid <span style="color:#40a070">1999</span>
</pre></div><p>数字，区分与其他的网络ID，以太坊公链的网络ID=1。必须区分，以放置钱包等误认为是以太坊公链。 ,2=Morden (disused), 3=Ropsten, 4=Rinkeby，默认为1。</p><div class="highlight" style="background:#f0f0f0"><pre style="line-height:125%"><span></span>--port <span style="color:#40a070">30303</span>
</pre></div><p>P2P网络监听端口，默认30303。</p><div class="highlight" style="background:#f0f0f0"><pre style="line-height:125%"><span></span>--fast 
</pre></div><p>这个命令是 Geth1.6.0之前的，只会被改成<code>--syncmode=fast</code>，但该命令继续有效。配置此命令能够快速的同步区块</p><div class="highlight" style="background:#f0f0f0"><pre style="line-height:125%"><span></span>--cache<span style="color:#666">=</span><span style="color:#40a070">1024</span>
</pre></div><p>程序内置的可用内存，单位MB。默认是16MB(最小值)。可以根据服务器能力配置到56, 512, 1024 (1GB), or 2048 (2GB)。</p><div class="highlight" style="background:#f0f0f0"><pre style="line-height:125%"><span></span>geth --identity <span style="color:#4070a0">&quot;OneTestETH&quot;</span> --rpccorsdomain <span style="color:#4070a0">&quot;*&quot;</span> --nodiscover --rpcapi <span style="color:#4070a0">&quot;*&quot;</span>  --fast --cache<span style="color:#666">=</span><span style="color:#40a070">1024</span> --networkid <span style="color:#40a070">1999</span>  console
</pre></div><p>进入控制台后，可以启动矿工开始挖矿。</p><div class="highlight" style="background:#f0f0f0"><pre style="line-height:125%"><span></span>&gt; miner.start<span style="color:#666">(</span><span style="color:#40a070">1</span><span style="color:#666">)</span>
</pre></div><p>这里的<code>1</code>表示只使用一个线程运行，如果配置过高我的MAC会卡。</p><div class="highlight" style="background:#f0f0f0"><pre style="line-height:125%"><span></span>INFO [09-09|11:17:36] Updated mining threads                  threads=1
INFO [09-09|11:17:36] Transaction pool price threshold updated price=18000000000
INFO [09-09|11:17:36] Starting mining operation
null
&gt; INFO [09-09|11:17:36] Commit new mining work                  number=1 txs=0 uncles=0 elapsed=134.574µs
INFO [09-09|11:17:38] Generating DAG in progress              epoch=0 percentage=0 elapsed=1.051s
INFO [09-09|11:17:39] Generating DAG in progress              epoch=0 percentage=1 elapsed=2.087s
INFO [09-09|11:17:40] Generating DAG in progress              epoch=0 percentage=2 elapsed=3.129s
INFO [09-09|11:17:41] Generating DAG in progress              epoch=0 percentage=3 elapsed=4.229s
......
INFO [09-09|11:19:24] Generating DAG in progress              epoch=0 percentage=98 elapsed=1m47.287s
INFO [09-09|11:19:25] Generating DAG in progress              epoch=0 percentage=99 elapsed=1m48.790s
INFO [09-09|11:19:25] Generated ethash verification cache      epoch=0 elapsed=1m48.792s
INFO [09-09|11:19:29] Generating DAG in progress              epoch=1 percentage=0  elapsed=1.365s
INFO [09-09|11:19:30] Generating DAG in progress              epoch=1 percentage=1  elapsed=2.666s
INFO [09-09|11:19:31] Successfully sealed new block            number=1 hash=19b30c…c712b6
INFO [09-09|11:19:31] 🔨 mined potential block                  number=1 hash=19b30c…c712b6
INFO [09-09|11:19:31] Commit new mining work                  number=2 txs=0 uncles=0 elapsed=421.087µs
</pre></div><p>第一次运行时将开始创建DAG文件，只需等待进度条到100，则将开始挖矿。 实际你看到的挖矿速度很快，这是因为我们已经在初始化创世区块时配置为:<code>&quot;nonce&quot;: &quot;0x0000000000000042&quot;</code>。 &ldquo;0x42&rdquo;难度能让你在私有测试网链上快速挖以太币。几分钟就会有上百个以太币，远远超过了在网络上测试交易所需的数量。</p><div class="highlight" style="background:#f0f0f0"><pre style="line-height:125%"><span></span>coinbase: 0xe7a614776754b7c7ef3a1ef6430d29e90411fd75
</pre></div><p>挖矿时必然有矿工账户，而系统默认使用创建的第一个账号。</p><div class="highlight" style="background:#f0f0f0"><pre style="line-height:125%"><span></span>&gt; miner.stop<span style="color:#666">()</span>
</pre></div><p>停止挖矿，此时可以查看将挖出不少以太币。在控制台中可查询矿工余额。</p><div class="highlight" style="background:#f0f0f0"><pre style="line-height:125%"><span></span>&gt; eth.accounts
</pre></div><p>这会返回到你拥有的账户地址排列。</p><div class="highlight" style="background:#f0f0f0"><pre style="line-height:125%"><span></span>&gt; eth.getBalance<span style="color:#666">(</span>eth.accounts<span style="color:#666">[</span><span style="color:#40a070">0</span><span style="color:#666">])</span>
</pre></div><p>这个控制台指令会返回到你第一个以太坊地址。因为我们只创建了一个账号，也将是矿工的账号。 而<code>eth.getBalance()</code>返回的余额是以太币的最小面额wei，</p><div class="highlight" style="background:#f0f0f0"><pre style="line-height:125%"><span></span>&gt; <span style="color:#bb60d5">primary</span> <span style="color:#666">=</span> eth.accounts<span style="color:#666">[</span><span style="color:#40a070">0</span><span style="color:#666">]</span>
&gt; <span style="color:#bb60d5">balance</span> <span style="color:#666">=</span> web3.fromWei<span style="color:#666">(</span>eth.getBalance<span style="color:#666">(</span>primary<span style="color:#666">)</span>, <span style="color:#4070a0">&quot;ether&quot;</span><span style="color:#666">)</span>;
</pre></div><p>将返回矿工的以太币余额，将wei转换为以太币ether。</p><h2 id="安装使用以太坊钱包">安装使用以太坊钱包</h2><p>以太坊钱包，当前以改名为Mist，到<a href="https://ethereum.org/">以太坊官网</a>下载最新版本。 <img src="https://static.yushuangqi.com/blog/2017/42295563.png" alt=""> 下载后，启动Mist,稍等片刻将在右上角显示<code>PRIVATE-NEW</code>，随后点击[Launch Application]进入主页。 <img src="https://static.yushuangqi.com/blog/2017/42012731.png" alt=""> 主页左下角红色标记为私有链，中间账号显示的是前面步骤中创建的账号，并有注明为主账号。</p><p><img src="https://static.yushuangqi.com/blog/2017/42169193.png" alt=""> 此时你可以继续使用命令新建账号，也可在钱包中创建账号。以太坊钱包Mist使用教程请另行<a href="https://github.com/EthFans/wiki/wiki/以太坊钱包-Mist-使用教程">查看</a>。</p><h2 id="结尾">结尾</h2><p>不知是否有疑问以太坊钱包Mist是如何关联上你运行的私有链的？</p><p>这是因为在运行私有链控制台时，实际以开启了IPC服务，显示的路径为：</p><div class="highlight" style="background:#f0f0f0"><pre style="line-height:125%"><span></span>INFO [09-09|10:40:38] IPC endpoint opened: /Users/one/Library/Ethereum/geth.ipc
</pre></div><p>而钱包在启动时默认在本机查找的IPC路径，而Mac OS上默认查找路径为: <code>$HOME/Library/Ethereum/geth.ipc</code>。所以钱包启动后能自动识别到你的私有链。 其他OS的默认查找路径如下,具体可查看<a href="https://github.com/ethereum/mist/blob/master/modules/settings.js#L248">源代码</a></p><ul><li>windows: .\pipe\geth.ipc</li><li>linux: /.ethereum/geth.ipc</li><li>freebsd: /.ethereum/geth.ipc</li><li>sunos: /.ethereum/geth.ipc</li></ul><p>至此，如上为Mac下搭建运行以太坊私有链环境的操作过程，如有疑问可在下方留言。</p></div><aside id="meta"><meta itemprop="wordCount" content="786"><meta itemprop="url" content="https://yushuangqi.com/blog/2017/mac%E4%B8%8B%E6%90%AD%E5%BB%BA%E4%BB%A5%E5%A4%AA%E5%9D%8A%E7%A7%81%E6%9C%89%E9%93%BE.html"></aside></article><div><div class="attribution"><div class="bdsharebuttonbox"><a href="#" class="bds_more" data-cmd="more"></a><a href="#" class="bds_weixin" data-cmd="weixin" title="分享到微信"></a><a href="#" class="bds_tsina" data-cmd="tsina" title="分享到新浪微博"></a><a href="#" class="bds_qzone" data-cmd="qzone" title="分享到QQ空间"></a><a href="#" class="bds_youdao" data-cmd="youdao" title="分享到有道云笔记"></a><a href="#" class="bds_mshare" data-cmd="mshare" title="分享到一键分享"></a></div><script>window._bd_share_config={"common":{"bdSnsKey":{},"bdText":"","bdMini":"2","bdMiniList":["mshare","qzone","tsina","bdysc","weixin","tqq","tieba","douban","sqq","youdao","qingbiji","mail","evernotecn","copy","print"],"bdPic":"","bdStyle":"0","bdSize":"32"},"share":{}};with(document)0[(getElementsByTagName('head')[0]||body).appendChild(createElement('script')).src='http://bdimg.share.baidu.com/static/api/js/share.js?v=89860593.js?cdnversion='+~(-new Date()/36e5)];</script></div><div><ul class="rel_links"><li class="rel_linksli"><span id="topics">分类: <a href="/topics/%E7%BC%96%E7%A8%8B%E8%AF%AD%E8%A8%80%E4%B8%8E%E5%BC%80%E5%8F%91.html" rel="category">编程语言与开发</a> </span><span id="tags">标签: <a href="/tags/%E4%BB%A5%E5%A4%AA%E5%9D%8A.html" rel="tag">以太坊</a></span></li><li class="rel_linksli rel_next"><a href="https://yushuangqi.com/blog/2017/ji-shu-da-niu-cheng-zhang.html">技术大牛成长</a></li></ul></div><aside id="comments"><div><div id="cyEmoji" role="cylabs" data-use="emoji" sid="15929b0fb4a59fc14f80a3f5178006fd"></div><div id="cyReward" role="cylabs" data-use="reward" sid="15929b0fb4a59fc14f80a3f5178006fd" style="text-align:center"></div><div id="SOHUCS" sid="15929b0fb4a59fc14f80a3f5178006fd"></div><script type="text/javascript">(function(){ 
var appid = 'cyt7HM6Iq'; 
var conf = 'prod_90e85fc8b207249a2493340f99075c94'; 
var width = window.innerWidth || document.documentElement.clientWidth; 
if (width < 960) { 
window.document.write('<script id="changyan_mobile_js" charset="utf-8" type="text/javascript" src="https://changyan.sohu.com/upload/mobile/wap-js/changyan_mobile.js?client_id=' + appid + '&conf=' + conf + '"><\/script>'); 
}else{ 
  var loadJs=function(d,a){
    var c=document.getElementsByTagName("head")[0]||document.head||document.documentElement;var b=document.createElement("script");
    b.setAttribute("type","text/javascript");
    b.setAttribute("charset","UTF-8");
    b.setAttribute("src",d);
    if(typeof a==="function"){if(window.attachEvent){b.onreadystatechange=function(){var e=b.readyState;if(e==="loaded"||e==="complete"){b.onreadystatechange=null;a()}}}else{b.onload=a}}c.appendChild(b)};
   loadJs("https://changyan.sohu.com/upload/changyan.js",function(){window.changyan.api.config({appid:appid,conf:conf})}); } })();</script><script type="text/javascript" charset="utf-8" src="https://changyan.itc.cn/js/lib/jquery.js"></script><script type="text/javascript" charset="utf-8" src="https://changyan.sohu.com/js/changyan.labs.https.js?appid=cyt7HM6Iq"></script></div></aside><div><section id="author"><h4>关于作者</h4><p><strong>虞双齐</strong>，一名全栈开发工程师，#热爱编程、#工具控、#爱读书、#宅男</p><p>活跃在 <a href="https://www.zhihu.com/people/_ysqi" title="虞双齐知乎主页">知乎</a>，开源项目在<a href="http://github.com/ysqi" rel="nofollow">Github</a>，博文分享在 <a href="https://yushuangqi.com" title="虞双齐的博客">个人博客</a>上。</p></section></div></div></section><section id="sidebar" role="complementary"><aside class="writings"><a href="/" class="sideimg sideimgwritings">Home</a> <q class="dquote">读书之法，莫贵于循序而致精。<cite>—宋·朱熹《性理精义》</cite></q><ul class="rel_links"><li class="rel_linksli"><a href="http://weibo.com/234665601" title="关注虞双齐的微博" rel="nofollow">我的微博</a></li><li class="rel_linksli"><a href="https://github.com/ysqi" title="访问虞双齐的Github" rel="nofollow">我的 Github</a></li><li class="rel_linksli"><a href="https://www.zhihu.com/people/_ysqi" title="访问虞双齐的知乎" rel="nofollow">我的 知乎</a></li></ul></aside><aside><div class="ds-recent-comments" data-num-items="5" data-show-avatars="1" data-show-time="1" data-show-title="1" data-show-admin="1" data-excerpt-length="70"></div></aside></section><nav id="menu" role="navigation"><ul id="nav" class="navlist"><li class="navtop"><a class="navtoplink" href="#page"><span>Top</span></a></li><li><a class="navabout" href="https://yushuangqi.com"><span>首页</span></a></li><li><a class="navwritings" href="/topics/"><span>博文</span></a></li><li><a class="navpresos" href="/book.html"><span>电子书</span></a></li><li><a class="navabout" href="/about.html"><span>关于我</span></a></li></ul></nav></div><footer class="site-footer"><ul class="footeractions"><li><a class="footeraction" href="http://weibo.com/234665601" rel="nofollow" title="在微博关注 虞双齐"><span class="footeractionWeibo">Weibo</span></a></li><li><a class="footeraction" href="https://www.zhihu.com/people/_ysqi" rel="nofollow" title="在微博关注 虞双齐"><span class="footeractionZhiHu">知乎</span></a></li><li><a class="footeraction" href="/index.xml" title="RSS订阅 虞双齐"><span class="footeractionRSS">Feed</span></a></li><li><a class="footeraction" href="http://validator.w3.org/check?uri=https%3a%2f%2fyushuangqi.com%2fblog%2f2017%2fmac%25E4%25B8%258B%25E6%2590%25AD%25E5%25BB%25BA%25E4%25BB%25A5%25E5%25A4%25AA%25E5%259D%258A%25E7%25A7%2581%25E6%259C%2589%25E9%2593%25BE.html" rel="nofollow" target="blank"><span class="footeractionW3CHTML">Valid XHTMl 4.0</span></a></li><li><a class="footeraction" href="http://jigsaw.w3.org/css-validator/validator?uri=https%3a%2f%2fyushuangqi.com%2fblog%2f2017%2fmac%25E4%25B8%258B%25E6%2590%25AD%25E5%25BB%25BA%25E4%25BB%25A5%25E5%25A4%25AA%25E5%259D%258A%25E7%25A7%2581%25E6%259C%2589%25E9%2593%25BE.html" rel="nofollow" target="blank"><span class="footeractionW3CCSS">Valid CSS Leval2</span></a></li></ul><p>©2015-2016 虞双齐-全栈开发。欢迎<a href="/about.html" rel="nofollow">联系我</a>，<a href="http://www.miitbeian.gov.cn/" target="bank" rel="nofollow" style="color:#c9c9c9">粤ICP备14032560号-4</a></p></footer><script>var _hmt = _hmt || [];
  (function() {
    var hm = document.createElement("script");
    hm.src = "https://hm.baidu.com/hm.js?a16b3275b071ec0efc507a05422a7156";
    var s = document.getElementsByTagName("script")[0]; 
    s.parentNode.insertBefore(hm, s);
  })();</script></body></html>