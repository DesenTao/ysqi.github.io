<!DOCTYPE html><html lang="zh" id="doc" class="no-js"><head><title>老虞学Golang-控制语句 |虞双齐Go语言开发</title><meta name="description" content=""><meta name="keywords" content="Go, 笔记, 教程, "><meta name="author" content="虞双齐"><meta name="generator" content="Hugo 0.17"><meta name="viewport" content="width=device-width,initial-scale=1"><meta name="renderer" content="webkit"><meta name="applicable-device" content="pc,mobile"><meta name="MobileOptimized" content="width"><meta name="HandheldFriendly" content="true"><meta name="mobile-web-app-capable" content="yes"><link rel="icon" sizes="192x192" href="/img/app-icon64x64@2x.png"><meta name="apple-mobile-web-app-capable" content="yes"><meta name="apple-mobile-web-app-status-bar-style" content="black"><meta name="apple-mobile-web-app-title" content="Ysqi"><link rel="apple-touch-icon-precomposed" href="/img/app-icon64x64@2x.png"><meta name="msapplication-TileImage" content="/img/app-icon64x64@2x.png"><meta name="msapplication-TileColor" content="#0e90d2"><meta property="og:type" content="article"><meta property="og:description" content=""><meta property="og:title" content="老虞学Golang-控制语句 : https://yushuangqi.com"><meta property="og:site_name" content="虞双齐Go语言开发"><meta property="og:url" content="https://yushuangqi.com/blog/2013/ysqi-golang-if-for-select-switch.html"><meta property="og:locale" content="zh"><meta property="article:published_time" content="2013-04-08 23:31:47"><meta property="article:modified_time" content="2013-04-08 23:31:47"><meta property="article:tag" content="Go"><meta property="article:tag" content="笔记"><meta property="article:tag" content="教程"><link rel="stylesheet" type="text/css" href="/css/jiandan.css?v=20160318"><script type="text/javascript">var doc = document.getElementById('doc');
	doc.removeAttribute('class', 'no-js');
	doc.setAttribute('class', 'js');</script><script type="text/javascript">var changeActive = function() {
		var page = document.getElementById("page");		
		if (page.getAttribute("class") === "not-active") {
			page.setAttribute("class", "active-sidebar");		
		} else if (page.getAttribute("class") === "active-sidebar") {
			page.setAttribute("class", "not-active");
		}		
	}
	
	window.onload = function() {
		if(document.getElementById("sidebar-button")) {
			var sidebar_button = document.getElementById("sidebar-button");
			sidebar_button.onclick = function(event) {
				changeActive();
				event.preventDefault();
			}
		}
		
	}
	
	window.onresize = function() {
		var page = document.getElementById("page");	
		page.setAttribute("class", "not-active");	
	}</script></head><body id="page" class="not-active"><div class="container"><header class="header writingsheader"><nav class="off-canvas-nav-links"><ul><li class="menuli"><a class="menubutton" href="#menu">Menu</a></li><li id="site-title"><a class="menulogo" id="sidebar-button" href="#sidebar">附件信息</a></li></ul></nav></header><section role="main"><article class="entry writingsentry" itemscope itemtype="http://schema.org/BlogPosting"><header><h2 itemprop="headline"><a rel="bookmark">老虞学Golang-控制语句</a></h2><p class="attribution"><span itemprop="author"><span itemscope itemtype="http://schema.org/Person">文/<a href="https://yushuangqi.com"> <span itemprop="name">虞双齐</span></a> </span></span><span class="right"><time itemprop="datePublished" datetime="2013-04-08">2013年04月08日</time></span></p></header><div itemprop="articleBody"><p>Go中的控制语句较精简，仅有if、for、select和switch。但使用时均比较灵活</p><h1 id="if">if</h1><p>在Go中条件语句*if*中如果条件部分的计算结果为<strong>true</strong>时将执行语句块，否则则执行else语句块(如果存在else时)，此逻辑和其他语言中的if一样，但是在Go中还是有一些不同之处。</p><ul><li>if条件表达式不能使用花括号<strong>()</strong>包含</li><li>if语句代码段必须使用<strong>{}</strong>，并且左括号必须和if在同一行</li><li>if条件表达式的前面可以包含初始化语句，支持平行赋值，但不支持多个赋值语句</li></ul><p>赋值+条件判断</p><pre><code class="language-go">	if a, b := 21, 3; a &gt; b {
		fmt.Println(&quot;a&gt;b ? true&quot;)
	}
</code></pre><p>在if条件表达式前面声明的的变量只能在if-else语句块中使用。</p><pre><code class="language-go">    if a, b := 21, 31; a &gt; b {
		fmt.Println(&quot;a&gt;b ? true&quot;)
	}else {
		fmt.Println(a,b) //Ok
	}
	fmt.Println(a,b)    //error: undefined a ,undefined b
</code></pre><p>还需要注意的是如果在<code>if-else</code> 中包含return 时，编译器无法解析出else中的retrun,导致方法缺少return ,目前1.1版本已支持该方式。</p><pre><code class="language-go">	func getName(id int) string {
		if id == 1 {
			return &quot;YourName&quot;
		}else {
			return &quot;MyName&quot;  
		}
        //panic(&quot;&quot;)
	}
</code></pre><p>此代码编译不通过，错误信息：<code>function ends without a return statement</code>，这是在设计Go时故意这样的,也可以说是一个Bug（可参见:<a href="https://code.google.com/p/go/issues/detail?id=65">https://code.google.com/p/go/issues/detail?id=65</a>），这是一种编码风格，即在if语句块中去做return处理,而else中不处理，而是继续执行if-else后面的代码，这样能减少一个代码缩进，不需要在了解代码时去记住else语句块的处理。当然如果想必须这样写,也可以进行特殊处理，在函数的末行添加语句<strong>panic(&ldquo;&rdquo;)</strong></p><p>在if中可以包含初始化语句，这是非常实用的。例如在文件处理，取字典项时需要判断是否执行操作成功，只有在成功时才能继续处理，这样就可以通过if-else处理。</p><pre><code class="language-go">	if err := file.Chmod(0664); err != nil {
	    log.Print(err)
	    return err
	}

	if v,err :=myMap[key];err != nil {
		log.Print(err)
		return err
	}else {
		//do something with v
	}
</code></pre><h1 id="for">for</h1><p>在Go中其他循环遍历的控制语句，唯有for。而for同样也是比较灵活的，for有三种形式。</p><ul><li>普通用法 <code>for init; condition;post {}</code></li><li>while <code>for condition {}</code></li><li>死循环 <code>for {}</code></li></ul><p>由于Go没有逗号表达式，而++和&ndash;是语句而不是表达式，如果想在for中执行多个变量,需要使用平行赋值</p><pre><code class="language-go">	for i, j := 1, 10; i &lt; j; i,j=i+1,j+1 {  //死循环
		fmt.Println(i)
	}
</code></pre><p>而不能写成</p><pre><code class="language-go">	for i, j := 1, 10; i &lt; j; i++,j++ {
		fmt.Println(i)
	}
</code></pre><p>for的condition在每执行一次循环体时便会执行一次，因此在实际开发过程中需要注意不要让condition中计算简单而不是复杂。</p><pre><code>for i,j :=0,len(str); i&lt;j ; i++ {
    fmt.Println(str[i])
}
</code></pre><p>而不要写成(这仅是一个演示而已)</p><pre><code>for i=0; i&lt; len(str); i++ {
    fmt.Println(str[i])
}
</code></pre><p>另外for是遍历string,array,slice,map,chanel的方式,而使用保留字rang则能灵活的处理。rang是迭代器，能根据不同的内容，返回不同的东西。</p><ul><li><code>for index,char := range string {}</code></li><li><code>for index,value := range array {}</code></li><li><code>for index,value := range slice {}</code></li><li><code>for key,value := range map {}</code></li></ul><p>需要注意的是for+rang遍历string时得到的是字节索引位置和UTF-8格式rune类型数据(int32)。</p><pre><code class="language-go">	for pos, value := range &quot;Go在中国&quot; {
		fmt.Printf(&quot;character '%c' type is %T value is %v, and start at byte position %d \n&quot;, value,value,value, pos)
	 	str :=string(value)  //convert rune to string
		fmt.Printf(&quot;string(%v)=&gt;%s \n&quot;,value,str)
	}
    ---------OutPut------------ 一个汉字占三个字节
	character 'G' type is int32 value is 71, and start at byte position 0
	string(71)=&gt;G
	character 'o' type is int32 value is 111, and start at byte position 1
	string(111)=&gt;o
	character '在' type is int32 value is 22312, and start at byte position 2
	string(22312)=&gt;在
	character '中' type is int32 value is 20013, and start at byte position 5
	string(20013)=&gt;中
	character '国' type is int32 value is 22269, and start at byte position 8
	string(22269)=&gt;国
</code></pre><p>###break和continue 另外在循环中使用break和continue，break用于退出循环，continue用于终止本次循环体的执行继续执行下一个循环。</p><pre><code class="language-go">	sum := 0
	for {
		if sum &gt; 10 {
			break
		}
		sum += 2
	}
	fmt.Println(sum) // sum=12
</code></pre><p>break也可退出指定的循环体</p><pre><code class="language-go">		sum := 0
	myforLable:
		for {
			for i := 0; i &lt; 10; i++ {
				if sum &gt; 200 {
					break myforLable //将退出循环体for{}
				}
				sum += i
			}
		}
		fmt.Println(sum)
</code></pre><h1 id="switch">switch</h1><p>switch是最灵活的一种控制语句,表达式可以不是常量或者字符串，也可以沒有表达式，如果没有表达式则如同if-else-else。</p><p>一般用法:和其他语言的Switch基本一样，不同的不需要在每个Case中添加Break,而是隐藏了Break,当然你可以显示加入break</p><pre><code class="language-go">	switch ch {
		case '0':
			cl = &quot;Int&quot;
		case '1':
			cl = &quot;Int&quot;
		case 'A':
			cl = &quot;ABC&quot;
			break //可以添加
		case 'a':
			cl = &quot;ABC&quot;
		default:
			cl = &quot;Other Char&quot;
	 }
</code></pre><p>此段代码可以可写成(fallthrough表示继续执行下面的Case而不是退出Switch)</p><pre><code>switch ch {
case '0':
    fallthrough   //必须是最后一个语句
case '1':
    cl = &quot;Int&quot;
case 'A':
case 'a':
    fallthrough
    cl = &quot;ABC&quot;    //error
default:
    cl = &quot;Other Char&quot;
}
</code></pre><p>如果多个匹配结果所对应的代码段一样，则可以在一个case中并列出所有的匹配项</p><pre><code class="language-go">	switch ch {
		case '0', '1', '2', '3', '4', '5', '6', '7', '8', '9':
			cl = &quot;Int&quot;
		case 'A', 'B', 'C', 'D',  'a', 'b', 'c', 'd', 'e':
			cl = &quot;ABC&quot;
		default:
			cl = &quot;Other Char&quot;
	}
</code></pre><p>同样switch可以没有表达式，在 Case 中使用布尔表达式，这样形如 if-else</p><pre><code class="language-go">	switch {
		case '0' &lt;= ch &amp;&amp; ch &lt;= '9':
			cl = &quot;Int&quot;
		case ('a' &lt;= ch &amp;&amp; ch &lt;= 'z') || ('A' &lt;= ch &amp;&amp; ch &lt;= 'Z'):
			cl = &quot;ABC&quot;
		default:
			cl = &quot;Other Char&quot;
	}
</code></pre><p>下面是Switch写的一个示例（无实际意义）：</p><pre><code class="language-go">	func Compare(a, b interface{}) (int, error) {
		aT := reflect.TypeOf(a)
		bT := reflect.TypeOf(b)
		if aT != bT {
			return -2, errors.New(&quot;进行比较的数据类型不一致&quot;)
		}

		switch av := a.(type) {

		default:
			return -2, errors.New(&quot;该类型数据比较没有实现&quot;)
		case string:
			switch bv := b.(type) {
			case string:
				return ByteCompare(av, bv), nil
			}
		case int:
			switch bv := b.(type) {
			case int:
				return NumCompare(av, bv), nil
			}

		}

		return -2, nil
    }
</code></pre><h1 id="select">select</h1><p>还有另一个控制语句select，在讨论chan 时再来学习</p><p>本笔记中所写代码存储位置：</p><ul><li><a href="https://github.com/devYu/GoLangStudy/tree/master/codeDemo/defer.go">defer.go</a></li><li><a href="https://github.com/devYu/GoLangStudy/tree/master/codeDemo/defineFunctionType.go">defineFunctionType.go</a></li><li><a href="https://github.com/devYu/GoLangStudy/tree/master/codeDemo/function.go">function.go</a></li></ul><p><a href="https://github.com/devYu/GoLangStudy/blob/master/myNotes/arrayAndSlice.md">上一篇(数组和切片)</a></p><p><a href="https://github.com/devYu/GoLangStudy/blob/master/myNotes/function.md">下一篇（函数上）</a></p></div><aside id="meta"><div class="share_sec2"><div class="bdsharebuttonbox"><a href="#" class="bds_more" data-cmd="more"></a><a href="#" class="bds_weixin" data-cmd="weixin" title="分享到微信"></a><a href="#" class="bds_tsina" data-cmd="tsina" title="分享到新浪微博"></a><a href="#" class="bds_qzone" data-cmd="qzone" title="分享到QQ空间"></a><a href="#" class="bds_youdao" data-cmd="youdao" title="分享到有道云笔记"></a><a href="#" class="bds_mshare" data-cmd="mshare" title="分享到一键分享"></a></div><script>window._bd_share_config={"common":{"bdSnsKey":{},"bdText":"","bdMini":"2","bdMiniList":["mshare","qzone","tsina","bdysc","weixin","tqq","tieba","douban","sqq","youdao","qingbiji","mail","evernotecn","copy","print"],"bdPic":"","bdStyle":"0","bdSize":"32"},"share":{}};with(document)0[(getElementsByTagName('head')[0]||body).appendChild(createElement('script')).src='http://bdimg.share.baidu.com/static/api/js/share.js?v=89860593.js?cdnversion='+~(-new Date()/36e5)];</script></div><ul class="rel_links"><li class="rel_linksli"><a href="">老虞学Golang-函数上</a></li><li class="rel_linksli"><a href="">老虞学golang-字符串</a></li><li class="rel_linksli"><a href="">老虞学Golang-常量</a></li><li class="rel_linksli rel_prev"><a href="https://yushuangqi.com/blog/2015/golang-php-gzencode-difrent.html">为什么golang的gzip和php的gzencode压缩结果不一样</a></li><li class="rel_linksli rel_next"><a href="https://yushuangqi.com/blog/2013/ysqi-golang-function-1.html">老虞学Golang-函数上</a></li><li class="rel_linksli"><span id="topics">分类: <a href="/topics/%E5%BC%80%E5%8F%91.html" rel="category">开发</a> </span><span id="tags">标签: <a href="/tags/go.html" rel="tag">Go</a> <a href="/tags/%E6%95%99%E7%A8%8B.html" rel="tag">教程</a> <a href="/tags/%E7%AC%94%E8%AE%B0.html" rel="tag">笔记</a></span></li></ul><aside id="comments"><div><h5 style="border-left:4px solid #ee9d05">评论</h5><div class="ds-thread" data-thread-key="80bfe28f02a13f6e20619b82df05c2d2" data-title="老虞学Golang-控制语句" data-url="https://yushuangqi.com/blog/2013/ysqi-golang-if-for-select-switch.html"></div></div></aside><div><section id="author"><h4>About author</h4><p><strong>虞双齐</strong>，开源爱好者，个人承接Golang语言开发。专注Golang、开源协作、微信平台开发和工作经验的分享。</p><p>动态分享到微博<a href="http://weibo.com/234665601" rel="nofollow">@虞双齐</a>，代码存放在 <a href="http://github.com/ysqi" rel="nofollow">Github</a>，博文分享在<a href="https://yushuangqi.com" title="虞双齐Golang开发博客">个人博客</a>上 ，分享经验。</p></section></div><meta itemprop="wordCount" content="569"><meta itemprop="url" content="https://yushuangqi.com/blog/2013/ysqi-golang-if-for-select-switch.html"></aside></article></section><section id="sidebar" role="complementary"><aside class="writings"><a href="/" class="sideimg sideimgwritings">Home</a> <q class="dquote">读书之法，莫贵于循序而致精。<cite>—宋·朱熹《性理精义》</cite></q><ul class="rel_links"><li class="rel_linksli"><a href="http://weibo.com/234665601" title="关注虞双齐的微博" rel="nofollow">我的微博</a></li><li class="rel_linksli"><a href="https://github.com/ysqi" title="访问虞双齐的Github" rel="nofollow">我的 Github</a></li></ul></aside><aside><div class="ds-recent-comments" data-num-items="5" data-show-avatars="1" data-show-time="1" data-show-title="1" data-show-admin="1" data-excerpt-length="70"></div></aside></section><nav id="menu" role="navigation"><ul id="nav" class="navlist"><li class="navtop"><a class="navtoplink" href="#page"><span>Top</span></a></li><li><a class="navabout" href="/"><span>首页</span></a></li><li><a class="navwritings" href="/topics/"><span>博文</span></a></li><li><a class="navpresos" href="/book.html"><span>电子书</span></a></li><li><a class="navabout" href="/about/"><span>关于我</span></a></li></ul></nav></div><footer class="site-footer"><ul class="footeractions"><li><a class="footeraction" href="http://weibo.com/234665601" rel="nofollow"><span class="footeractionWeibo">Follow on Weibo</span></a></li><li><a href="http://validator.w3.org/check?uri=https%3a%2f%2fyushuangqi.com%2fblog%2f2013%2fysqi-golang-if-for-select-switch.html" rel="nofollow" target="blank"><img src="http://static.yushuangqi.com/assets/valid-html401.png" alt="Valid XHTMl 4.0"></a></li><li><a href="http://jigsaw.w3.org/css-validator/validator?uri=https%3a%2f%2fyushuangqi.com%2fblog%2f2013%2fysqi-golang-if-for-select-switch.html" rel="nofollow" target="blank"><img src="http://static.yushuangqi.com/assets/valid-css2.png" alt="Valid XHTMl 4.0"></a></li></ul><p>©2015-2016 虞双齐产品设计与软件开发，个人诚接软件开发外包。欢迎<a href="/about/" rel="nofollow">联系我</a>，<a href="http://www.miitbeian.gov.cn/" target="bank" rel="nofollow" style="color:#c9c9c9">粤ICP备14032560号-4</a></p></footer><script type="text/javascript">var duoshuoQuery = {short_name:"ysqi"};
	(function() {
		var ds = document.createElement('script');
		ds.type = 'text/javascript';ds.async = true;
		ds.src = (document.location.protocol == 'https:' ? 'https:' : 'http:') + '//static.duoshuo.com/embed.js';
		ds.charset = 'UTF-8';
		(document.getElementsByTagName('head')[0] 
		 || document.getElementsByTagName('body')[0]).appendChild(ds);
	})();</script><script>(function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
  (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
  m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
  })(window,document,'script','//www.google-analytics.com/analytics.js','ga');
  ga('create', 'UA-44627932-2', 'auto');
  ga('send', 'pageview');</script></body></html>