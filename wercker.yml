build:
  box: samueldebruyn/hugo-build
  steps:
    - script:
        name: initialize git submodules
        code: |
            git submodule update --init --recursive
    - arjen/hugo-build:
        prod_branches: master
        disable_pygments: true
    - samueldebruyn/minify:
        only_on_branches: master
    - script:
        name: ls stuff
        code: |
          ls -haltr /pipeline/source/public
deploy:
  box: samueldebruyn/debian-git
  steps:
    - script:
        name: ls output
        code: |
          ls -haltr /pipeline/output

    - script:
        name: ls source
        code: |
          ls -haltr /pipeline/source
    - lukevivier/gh-pages:
        token: $GIT_TOKEN
        domain: www.yushuangqi.com
        basedir: public
    - add-ssh-key:
        keyname: DEPLOY_SSH
    - add-to-known_hosts:
        hostname: $DEPLOY_HOST
        fingerprint: 7e:ea:20:09:33:b9:1b:28:b5:da:96:d4:31:e4:52:cd
    - ysqi/git-push:
        host: $DEPLOY_HOST
        repo: myblog
        branch: master
        basedir: public